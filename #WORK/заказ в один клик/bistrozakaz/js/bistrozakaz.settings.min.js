!function(e){var t={settingsChanged:function(){var t=e("input[type=submit]");t.removeClass("green"),t.addClass("yellow")},submitGreen:function(){var t=e("input[type=submit]");t.removeClass("yellow"),t.addClass("green")}};e(document).ready(function(){var s={bzCloseText:"Скрыть CSS стили",bzOpenText:"Редактировать CSS стили"},a=e("#bz-editor-wrap");a.hide(0),a.data("state","closed");var n=ace.edit("bz-editor");n.getSession().setUseWrapMode(!0),n.getSession().setUseWorker(!1),n.getSession().setMode("ace/mode/css"),e("#bz-show-editor").click(function(t){var o=e(t.target);t.preventDefault(),"closed"===a.data("state")?a.slideDown(function(){o.text(s.bzCloseText),a.data("state","open"),n.resize()}):a.slideUp(function(){o.text(s.bzOpenText),a.data("state","closed")})}),e("#bz-css-2default").click(function(s){if(s.preventDefault(),confirm("Будут восстановлены стили по умолчанию!")){var o=e("#bz-css-2default i");o.removeClass("rotate-right"),o.addClass("loading"),e.ajax({type:"POST",url:"?plugin=bistrozakaz&module=tmpl&action=back",data:{_csrf:e('input[name="_csrf"]').val()},complete:function(){a.slideUp(function(){a.data("state","closed"),e.ajax({type:"POST",url:"?plugin=bistrozakaz&module=tmpl&action=get",data:{bz_tmpl_css:n.session.getValue(),_csrf:e('input[name="_csrf"]').val()},success:function(e){"ok"===e.status&&n.session.setValue(e.data.code)},complete:function(){e("#bz-show-editor").click(),t.submitGreen(),o.removeClass("loading"),o.addClass("rotate-right")},dataType:"json"})})}})}}),e("#plugins-settings-form").submit(function(){e.ajax({type:"POST",url:"?plugin=bistrozakaz&module=tmpl&action=put",data:{bz_tmpl_css:n.getSession().getValue(),_csrf:e('input[name="_csrf"]').val()},success:function(e){"ok"===e.status&&t.submitGreen()},dataType:"json"})}),e("input[type=checkbox], input[type=radio], input[type=text]").on("change",t.settingsChanged),n.getSession().on("change",t.settingsChanged)})}(jQuery);
